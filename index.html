<!DOCTYPE html>
<html>
<head>
    <title>מחיר קפה</title>
</head>
<body>
    <h1>מחיר הקפה:</h1>
    <p id="coffee-price">טוען...</p>

    <h2>עדכן מחיר</h2>
    <form id="update-price-form">
        <label for="new-price-input">מחיר חדש:</label>
        <input type="number" id="new-price-input" name="newPrice" required>
        <button type="submit">עדכן</button>
        <p id="update-message"></p>
    </form>

    <script>
        async function fetchPrice() {
            const response = await fetch('price.json');
            const data = await response.json();
            document.getElementById('coffee-price').textContent = data.coffeePrice + ' שקל';
        }

        async function updatePrice(event) {
            event.preventDefault();
            const newPriceInput = document.getElementById('new-price-input');
            const newPrice = newPriceInput.value;
            const updateMessage = document.getElementById('update-message');

            const response = await fetch('/.netlify/functions/updatePrice', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ newPrice }),
            });

            const data = await response.json();
            updateMessage.textContent = data.message;

            // לאחר העדכון (המדמה), נטען מחדש את המחיר (בפועל עדיין מהקובץ הסטטי)
            fetchPrice();
            newPriceInput.value = ''; // נקה את השדה
        }

        document.addEventListener('DOMContentLoaded', () => {
            fetchPrice();
            const form = document.getElementById('update-price-form');
            form.addEventListener('submit', updatePrice);
        });
    </script>
</body>
</html>
